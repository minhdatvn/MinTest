{% extends 'quiz_app/base.html' %}
{% load quiz_extras %}

{% block title %}K·∫øt qu·∫£: {{ attempt.quiz.quiz_name }}{% endblock %}

{% block content %}
    <div style="display:none;">{% csrf_token %}</div>
    <style>
        body {
            /* Th√™m padding-bottom ƒë·ªÉ thanh ƒëi·ªÅu h∆∞·ªõng kh√¥ng che m·∫•t n·ªôi dung */
            padding-bottom: 120px; 
        }
        .result-nav-panel {
            top: auto !important;
            bottom: 0;
            /* S·ª¨A L·∫†I: D√πng bi·∫øn cho m√†u n·ªÅn */
            background-color: var(--bs-tertiary-bg); 
            border-top: 1px solid var(--bs-border-color);
            z-index: 1020;
        }
        .result-nav-box {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border: 1px solid var(--bs-border-color);
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            /* S·ª¨A L·∫†I: D√πng bi·∫øn cho m√†u n·ªÅn v√† m√†u ch·ªØ */
            background-color: var(--bs-body-bg);
            color: var(--bs-body-color);
            user-select: none;
            transition: transform 0.2s;
        }
        .result-nav-box:hover {
            transform: scale(1.1);
        }
        .result-nav-box.active {
            /* Bootstrap s·∫Ω t·ª± x·ª≠ l√Ω m√†u cho tr·∫°ng th√°i active */
            background-color: var(--bs-primary);
            color: var(--bs-light);
            border-color: var(--bs-primary);
        }
        .result-nav-box.correct-result { background-color: #198754; color: white; }
        .result-nav-box.incorrect-result { background-color: #dc3545; color: white; }
        
        .question-review { border-top: 1px solid var(--bs-border-color); padding-top: 15px; }
        .answer-option { display: block; padding: 8px; margin: 4px 0; border-radius: 4px; list-style-type: none; }
        
        .selected-by-user { 
            border-left: 5px solid var(--bs-primary); 
            /* S·ª¨A L·∫†I: D√πng bi·∫øn cho m√†u n·ªÅn */
            background-color: var(--bs-primary-bg-subtle); 
        }
        .correct-answer { 
            /* S·ª¨A L·∫†I: D√πng bi·∫øn cho m√†u ch·ªØ v√† n·ªÅn */
            color: var(--bs-success-text-emphasis); 
            background-color: var(--bs-success-bg-subtle); 
        }
        .incorrect-selection { 
            /* S·ª¨A L·∫†I: D√πng bi·∫øn cho m√†u ch·ªØ, n·ªÅn v√† vi·ªÅn */
            color: var(--bs-danger-text-emphasis); 
            background-color: var(--bs-danger-bg-subtle); 
            border-left: 5px solid var(--bs-danger); 
        }
    </style>

    <div class="card shadow-sm mb-4">
        <div class="card-body p-4">
            <div class="row align-items-center">
                
                <div class="col-md-4 text-center mb-3 mb-md-0">
                    <div class="position-relative" style="max-width: 180px; max-height: 180px; margin: auto;">
                        <canvas id="scoreChart"></canvas>
                        <div id="chart-score-text" class="position-absolute top-50 start-50 translate-middle h2 fw-bold text-body-emphasis">0%</div>
                    </div>
                </div>

                <div class="col-md-8">
                    <h2 class="card-title">K·∫øt qu·∫£: {{ attempt.quiz.quiz_name }}</h2>
                    
                    {# D√πng filter 'percentage' v·ª´a t·∫°o #}
                    {% with percentage=attempt.score_achieved|percentage:attempt.quiz.scoring_scale_max %}
                        {% if percentage >= 80 %}
                            <h4 class="text-success fw-bold"><i class="bi bi-trophy-fill me-2"></i>Xu·∫•t s·∫Øc!</h4>
                            <p class="lead">B·∫°n ƒë√£ th·ªÉ hi·ªán m·ªôt s·ª± hi·ªÉu bi·∫øt tuy·ªát v·ªùi v·ªÅ ch·ªß ƒë·ªÅ n√†y.</p>
                        {% elif percentage >= 50 %}
                            <h4 class="text-primary fw-bold"><i class="bi bi-hand-thumbs-up-fill me-2"></i>L√†m t·ªët l·∫Øm!</h4>
                            <p class="lead">B·∫°n ƒë√£ n·∫Øm v·ªØng ph·∫ßn l·ªõn ki·∫øn th·ª©c quan tr·ªçng.</p>
                        {% elif percentage > 0 %}
                            <h4 class="text-warning fw-bold"><i class="bi bi-emoji-smile-fill me-2"></i>C·ªë g·∫Øng h∆°n nh√©!</h4>
                            <p class="lead">H√£y xem l·∫°i c√°c c√¢u tr·∫£ l·ªùi v√† th·ª≠ s·ª©c l·∫°i l·∫ßn n·ªØa ƒë·ªÉ c·∫£i thi·ªán ƒëi·ªÉm s·ªë.</p>
                        {% else %}
                            <h4 class="text-warning fw-bold"><i class="bi bi-tencent-qq me-2"></i>Ch·∫Øc ph·∫£i h√™n l·∫Øm m·ªõi xui ƒë∆∞·ª£c nh∆∞ v·∫≠y!</h4>
                            <p class="lead">X√°c su·∫•t ƒë∆∞·ª£c ƒëi·ªÉm 0 c√≤n th·∫•p h∆°n ƒëi·ªÉm 100. B·∫°n ƒë√£ l√†m ƒë∆∞·ª£c m·ªôt ƒëi·ªÅu kh√¥ng t∆∞·ªüng!</p>
                    {% endif %}
                        
                        <p class="h3 fw-bold mt-3">ƒêi·ªÉm c·ªßa b·∫°n: 
                            <span class="text-primary">{{ attempt.score_achieved|floatformat:2 }}</span> / {{ attempt.quiz.scoring_scale_max }}
                        </p>
                    {% endwith %}
                </div>
            </div>
        </div>

        <div class="text-center my-4">
            <div class="mb-3">
                {# N√∫t L√†m l·∫°i (kh√¥ng ƒë·ªïi) #}
                <a href="{% url 'start_quiz' attempt.quiz.template_for.id|default:attempt.quiz.id %}" class="btn btn-primary d-inline-flex align-items-center" title="L√†m l·∫°i b√†i thi n√†y">
                    <i class="bi bi-arrow-clockwise"></i>
                    <span class="ms-1">L√†m l·∫°i</span>
                </a>
            
                {# N√∫t Trang ch·ªß (ƒë√£ s·ª≠a text) #}
                <a href="{% if user.is_authenticated %}{% url 'dashboard' %}{% else %}{% url 'guest_homepage' %}{% endif %}" class="btn btn-secondary ms-2 d-inline-flex align-items-center" title="Quay l·∫°i trang ch√≠nh">
                    <i class="bi bi-house-door-fill"></i>
                    <span class="ms-1">Trang ch·ªß</span>
                </a>
            
                {# N√öT CHIA S·∫∫ M·ªöI #}
                <button type="button" id="share-result-btn" class="btn btn-info ms-2 d-inline-flex align-items-center" title="Chia s·∫ª k·∫øt qu·∫£">
                    <i class="bi bi-share-fill"></i>
                    <span class="ms-1">Chia s·∫ª</span>
                </button>
            </div>

            <div class="d-inline-flex align-items-center">
                <span class="me-2">Hi·ªÉn th·ªã k·∫øt qu·∫£ thi:</span>
                <div class="btn-group" role="group" aria-label="L·ªçc k·∫øt qu·∫£">
                    <button type="button" class="btn btn-sm btn-outline-secondary filter-btn" data-filter="all">T·∫•t c·∫£</button>
                    <button type="button" class="btn btn-sm btn-outline-success filter-btn" data-filter="correct">ƒê√∫ng</button>
                    <button type="button" class="btn btn-sm btn-outline-danger filter-btn" data-filter="incorrect">Sai</button>
                </div>
            </div>

        </div>

    <div class="review-container card d-none">
        <div class="card-header">
            <h2 class="mb-0">K·∫øt qu·∫£ chi ti·∫øt b√†i thi:</h2>
        </div>
        <div class="card-body">
            {% for answered_question in ordered_answered_questions %}
                <div class="result-question-container {% if not forloop.first %}d-none{% endif %}" id="result-question-{{ forloop.counter0 }}">
                    <div class="question-review">
                        <h4>C√¢u <span class="question-number-display">{{ forloop.counter }}</span>: {{ answered_question.question.question_text }}</h4>
                        <p><i>K·∫øt qu·∫£: {% if answered_question.is_correct %}ƒê√∫ng{% else %}Sai{% endif %}. ƒê∆∞·ª£c: {{ answered_question.points_earned|floatformat:2 }} ƒëi·ªÉm</i></p>  

                        <ul>
                            {% for option in answered_question.question.answers.all %}
                                {% if option in answered_question.selected_answers.all %}
                                    {% if option.is_correct %}
                                        <li class="answer-option correct-answer selected-by-user">
                                            {{ forloop.counter0|to_char }}.
                                            {{ option.answer_text }} (ƒê√°p √°n b·∫°n ch·ªçn ƒë√∫ng)
                                        </li>
                                    {% else %}
                                        <li class="answer-option incorrect-selection">
                                            {{ forloop.counter0|to_char }}.
                                            {{ option.answer_text }} (ƒê√°p √°n b·∫°n ch·ªçn sai)
                                        </li>
                                    {% endif %}
                                {% else %}
                                    {% if option.is_correct %}
                                        <li class="answer-option correct-answer">
                                            {{ forloop.counter0|to_char }}.
                                            {{ option.answer_text }} (ƒê√°p √°n ƒë√∫ng c·ªßa c√¢u h·ªèi)
                                        </li>
                                    {% else %}
                                        <li class="answer-option">
                                            {{ forloop.counter0|to_char }}.
                                            {{ option.answer_text }}
                                        </li>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    
    <nav class="navbar fixed-bottom result-nav-panel py-3 d-none">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <button type="button" id="prev-result-btn" class="btn btn-primary d-inline-flex align-items-center" title="C√¢u tr∆∞·ªõc" disabled>
                <i class="bi bi-arrow-left-circle-fill fs-4"></i>
                <span class="d-none d-sm-inline ms-2">C√¢u tr∆∞·ªõc</span>
            </button>

            <button class="btn btn-outline-secondary d-inline-flex align-items-center" type="button" data-bs-toggle="offcanvas" data-bs-target="#resultNavOffcanvas" aria-controls="resultNavOffcanvas" title="Danh s√°ch c√¢u h·ªèi">
                <i class="bi bi-list-task fs-4"></i>
                <span class="d-none d-sm-inline ms-1">Danh s√°ch</span>
            </button>

            <button type="button" id="next-result-btn" class="btn btn-primary d-inline-flex align-items-center" title="C√¢u ti·∫øp">
                <span class="d-none d-sm-inline me-2">C√¢u ti·∫øp</span>
                <i class="bi bi-arrow-right-circle-fill fs-4"></i>
            </button>
        </div>        
    </nav>

    <div class="offcanvas offcanvas-bottom d-none" tabindex="-1" id="resultNavOffcanvas" aria-labelledby="offcanvasLabel" style="height: 30vh;">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasLabel">ƒêi·ªÅu h∆∞·ªõng k·∫øt qu·∫£</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div id="result-navigator" class="d-flex flex-wrap justify-content-center gap-2 mx-auto">
                {% for answered_question in ordered_answered_questions %}
                    <div class="result-nav-box {% if answered_question.is_correct %}correct-result{% else %}incorrect-result{% endif %} {% if forloop.first %}active{% endif %}"
                         data-question-index="{{ forloop.counter0 }}">
                        {{ forloop.counter }}
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    {# MODAL D·ª∞ PH√íNG CHO VI·ªÜC CHIA S·∫∫ #}
    <div class="modal fade" id="shareResultModal" tabindex="-1" aria-labelledby="shareResultModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="shareResultModalLabel">Chia s·∫ª k·∫øt qu·∫£ c·ªßa b·∫°n</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ chia s·∫ª tr·ª±c ti·∫øp. Vui l√≤ng sao ch√©p n·ªôi dung d∆∞·ªõi ƒë√¢y v√† d√°n v√†o n∆°i b·∫°n mu·ªën chia s·∫ª.</p>
                    <textarea id="share-text-content" class="form-control" rows="6" readonly></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" id="copy-share-text-btn" class="btn btn-primary">
                        <i class="bi bi-clipboard"></i> Sao ch√©p n·ªôi dung
                    </button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block extra_js %}
{{ block.super }}
    {# N·∫°p th∆∞ vi·ªán Chart.js t·ª´ CDN #}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        
        // --- PH·∫¶N 1: LOGIC ƒêI·ªÄU H∆Ø·ªöNG K·∫æT QU·∫¢ (CODE G·ªêC C·ª¶A B·∫†N) ---
        const questionContainers = document.querySelectorAll('.result-question-container');
        const navBoxes = document.querySelectorAll('.result-nav-box');
        const nextBtn = document.getElementById('next-result-btn');
        const prevBtn = document.getElementById('prev-result-btn');
        const totalQuestions = questionContainers.length;
        let currentQuestionIndex = 0;
        
        function showQuestion(index) {
            if(index < 0 || index >= totalQuestions) return;
            questionContainers.forEach(container => container.classList.add('d-none'));
            if (questionContainers[index]) questionContainers[index].classList.remove('d-none');
            
            navBoxes.forEach(box => box.classList.remove('active'));
            if (navBoxes[index]) navBoxes[index].classList.add('active');

            if(prevBtn) prevBtn.disabled = (index === 0);
            if(nextBtn) nextBtn.disabled = (index === totalQuestions - 1);
            
            currentQuestionIndex = index;
        }

        if (nextBtn) nextBtn.addEventListener('click', () => { if (currentQuestionIndex < totalQuestions - 1) showQuestion(currentQuestionIndex + 1); });
        if (prevBtn) prevBtn.addEventListener('click', () => { if (currentQuestionIndex > 0) showQuestion(currentQuestionIndex - 1); });
        
        navBoxes.forEach(box => {
            box.addEventListener('click', function () {
                const index = parseInt(this.dataset.questionIndex, 10);
                showQuestion(index);
            });
        });

        if (totalQuestions > 0) {
            showQuestion(0);
        }

        // --- PH·∫¶N 2: LOGIC V·∫º BI·ªÇU ƒê·ªí (CODE M·ªöI) ---
        const ctx = document.getElementById('scoreChart');
        const scoreTextEl = document.getElementById('chart-score-text');

        if (ctx && scoreTextEl) {
            const userScore = parseFloat('{{ attempt.score_achieved|default:0|stringformat:".2f" }}');
            const maxScore = parseFloat('{{ attempt.quiz.scoring_scale_max|default:100|stringformat:".2f" }}');
            const remainingScore = Math.max(0, maxScore - userScore);
            // T√≠nh to√°n % cu·ªëi c√πng m·ªôt l·∫ßn duy nh·∫•t
            const finalPercentage = maxScore > 0 ? (userScore / maxScore) * 100 : 0;

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [userScore, remainingScore],
                        backgroundColor: [
                            '#198754', // Quay l·∫°i m√†u xanh l√° c√¢y ƒë∆°n gi·∫£n
                            '#f8f9fa'  // M√†u n·ªÅn x√°m r·∫•t nh·∫°t
                        ],
                        borderColor: 'var(--bs-body-bg)',
                        borderWidth: 2
                        // B·ªè c√°c thu·ªôc t√≠nh bo g√≥c v√† gradient
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    },
                    // --- PH·∫¶N ANIMATION M·ªöI ƒê·ªÇ S·ª¨A L·ªñI ƒê·∫æM % ---
                    animation: {
                        duration: 1500, // Th·ªùi gian animation
                        onProgress: function(animation) {
                            // animation.currentStep l√† b∆∞·ªõc animation hi·ªán t·∫°i
                            // animation.numSteps l√† t·ªïng s·ªë b∆∞·ªõc
                            // T·ª∑ l·ªá ho√†n th√†nh animation (t·ª´ 0.0 ƒë·∫øn 1.0)
                            const progress = animation.currentStep / animation.numSteps;
                            
                            // T√≠nh to√°n % ƒë·ªÉ hi·ªÉn th·ªã d·ª±a tr√™n t·ª∑ l·ªá ƒë√≥
                            const currentDisplayPercentage = progress * finalPercentage;
                            
                            scoreTextEl.textContent = `${Math.round(currentDisplayPercentage)}%`;
                        },
                        // ƒê·∫£m b·∫£o gi√° tr·ªã cu·ªëi c√πng lu√¥n ch√≠nh x√°c tuy·ªát ƒë·ªëi
                        onComplete: function(animation) {
                             scoreTextEl.textContent = `${Math.round(finalPercentage)}%`;
                        }
                    }
                }
            });
        }

        // --- PH·∫¶N 3: LOGIC L·ªåC K·∫æT QU·∫¢ ---
        const reviewContainer = document.querySelector('.review-container');
        const navPanel = document.querySelector('.result-nav-panel');
        const offcanvasPanel = document.getElementById('resultNavOffcanvas');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const allNavBoxes = document.querySelectorAll('.result-nav-box');

        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // === TH√äM LOGIC M·ªöI ƒê·ªÇ HI·ªÜN C√ÅC KH·ªêI B·ªä ·∫®N ===
                if (reviewContainer && reviewContainer.classList.contains('d-none')) {
                    reviewContainer.classList.remove('d-none');
                    navPanel.classList.remove('d-none');
                    offcanvasPanel.classList.remove('d-none');
                    reviewContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }        

                // C·∫≠p nh·∫≠t tr·∫°ng th√°i active cho c√°c n√∫t l·ªçc
                filterButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');

                const filter = this.dataset.filter;
                let firstVisibleQuestionIndex = -1;

                allNavBoxes.forEach((navBox, index) => {
                    const questionContainer = document.getElementById(`result-question-${index}`);
                    let show = false; // M·∫∑c ƒë·ªãnh l√† ·∫©n

                    // Ki·ªÉm tra ƒëi·ªÅu ki·ªán ƒë·ªÉ hi·ªÉn th·ªã
                    if (filter === 'all') {
                        show = true;
                    } else if (filter === 'correct' && navBox.classList.contains('correct-result')) {
                        show = true;
                    } else if (filter === 'incorrect' && navBox.classList.contains('incorrect-result')) {
                        show = true;
                    }
                    
                    // ·∫®n/hi·ªán c·∫£ √¥ s·ªë trong panel tr∆∞·ª£t v√† kh·ªëi c√¢u h·ªèi t∆∞∆°ng ·ª©ng
                    navBox.style.display = show ? 'flex' : 'none';
                    if (questionContainer) {
                        // L∆∞u √Ω: kh·ªëi c√¢u h·ªèi v·∫´n ƒë∆∞·ª£c ·∫©n/hi·ªán b·∫±ng d-none nh∆∞ c≈©
                        // n√™n ch√∫ng ta kh√¥ng thay ƒë·ªïi style.display c·ªßa n√≥ ·ªü ƒë√¢y
                        // m√† s·∫Ω d√πng h√†m showQuestion()
                    }

                    // T√¨m c√¢u h·ªèi ƒë·∫ßu ti√™n ƒë∆∞·ª£c hi·ªÉn th·ªã trong b·ªô l·ªçc
                    if (show && firstVisibleQuestionIndex === -1) {
                        firstVisibleQuestionIndex = index;
                    }
                });

                // T·ª± ƒë·ªông nh·∫£y ƒë·∫øn c√¢u h·ªèi ƒë·∫ßu ti√™n trong danh s√°ch ƒë√£ l·ªçc
                if (firstVisibleQuestionIndex !== -1) {
                    showQuestion(firstVisibleQuestionIndex);
                } else {
                    // N·∫øu kh√¥ng c√≥ c√¢u n√†o kh·ªõp (v√≠ d·ª•: l·ªçc c√¢u sai nh∆∞ng l√†m ƒë√∫ng h·∫øt)
                    // th√¨ ·∫©n h·∫øt c√°c container c√¢u h·ªèi
                    questionContainers.forEach(container => container.classList.add('d-none'));
                    // C√≥ th·ªÉ hi·ªÉn th·ªã m·ªôt th√¥ng b√°o ·ªü ƒë√¢y n·∫øu mu·ªën
                }
            });
        });
        
        // --- PH·∫¶N 4: LOGIC CU·ªêI C√ôNG CHO N√öT CHIA S·∫∫ ---
        const shareBtn = document.getElementById('share-result-btn');
        if (shareBtn) {
            const shareModalEl = document.getElementById('shareResultModal');
            const shareModal = new bootstrap.Modal(shareModalEl);
            const shareTextArea = document.getElementById('share-text-content');
            const copyBtn = document.getElementById('copy-share-text-btn');

            shareBtn.addEventListener('click', function() {
                // L·∫•y d·ªØ li·ªáu tr·ª±c ti·∫øp t·ª´ template
                const score = '{{ attempt.score_achieved|floatformat:2 }}';
                const maxScore = '{{ attempt.quiz.scoring_scale_max }}';
                const quizName = '{{ share_quiz_name|escapejs }}';
                const url = '{{ homepage_url }}';
                const accessCode = '{{ share_access_code|default:"" }}'; // L·∫•y m√£ ƒë√£ c√≥

                // X√¢y d·ª±ng n·ªôi dung chia s·∫ª cho API
                let textForApi = `üìù T√¥i v·ª´a ho√†n th√†nh ƒë·ªÅ thi "${quizName}" v·ªõi k·∫øt qu·∫£ ${score}/${maxScore}!`;

                // X√¢y d·ª±ng n·ªôi dung ƒë·∫ßy ƒë·ªß cho clipboard
                let textForClipboard = textForApi + '\n\n';
                if (accessCode) { // Ch·ªâ th√™m d√≤ng n√†y n·∫øu m√£ t·ªìn t·∫°i
                    textForClipboard += `M√£ tham gia ƒë·ªÅ thi n√†y l√†: ${accessCode}\n\n`;
                }
                textForClipboard += `B·∫°n c≈©ng c√≥ th·ªÉ th·ª≠ s·ª©c t·∫°i ƒë√¢y: ${url}`;

                const shareData = {
                    title: 'K·∫øt qu·∫£ thi tr·∫Øc nghi·ªám',
                    text: textForApi,
                    url: url,
                };

                if (navigator.share) {
                    navigator.share(shareData).catch((err) => console.error("L·ªói khi chia s·∫ª:", err));
                } else {
                    // Hi·ªÉn th·ªã modal v·ªõi n·ªôi dung ƒë·∫ßy ƒë·ªß cho vi·ªác sao ch√©p
                    shareTextArea.value = textForClipboard;
                    copyBtn.innerHTML = '<i class="bi bi-clipboard"></i> Sao ch√©p n·ªôi dung';
                    shareModal.show();
                }
            });

            // G·∫Øn s·ª± ki·ªán cho n√∫t sao ch√©p trong modal (kh√¥ng ƒë·ªïi)
            copyBtn.addEventListener('click', function() {
                shareTextArea.select();
                navigator.clipboard.writeText(shareTextArea.value).then(() => {
                    copyBtn.innerHTML = '<i class="bi bi-clipboard-check-fill text-success"></i> ƒê√£ ch√©p!';
                });
            });
        }
    });
    </script>
{% endblock %}